<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
        <link rel="stylesheet" href="http://code.jquery.com/jquery-1.10.2.min.js">
        <link rel="stylesheet" href="{{STATIC_URL}}css/normalize.min.css">
        <link rel="stylesheet" href="{{STATIC_URL}}css/bootstrap.css">
        <link rel="stylesheet" href="{{STATIC_URL}}css/main.css">
        <link rel="stylesheet" href="{{STATIC_URL}}css/utiles.css">
        <script src="{{STATIC_URL}}js/vendor/modernizr-2.6.2.min.js"></script>

    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <table>
        <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Subtotal</th>
            <th>Eliminar</th>
        </tr>
        {% for item in cart %}
        <tr>
            <td>{{ item.product.nombre }}</td>
            <td class="quantity">
                <input type="text" size="4" name="updates[{{item.variant.id}}]" id="updates_{{ item.variant.id }}" value="{{ item.quantity }}" onfocus="this.select();"/>

            </td>
            <td>{{ item.total_price }}
            </td>
            <td> <button class="item" value="{{item.product.id}}">Eliminar</button> </td>
        </tr>
        {% endfor %}

    </table>

     <p>Total: <span id="total_cart">{{ cart.total_cart}}</span></p>
    <button>Comprar</button>




<script>window.jQuery || document.write('<script src="{{STATIC_URL}}js/vendor/jquery-1.10.1.min.js"><\/script>')</script>
        <script src="{{STATIC_URL}}js/vendor/bootstrap.min.js"></script>
        <script src="{{STATIC_URL}}js/main.js"></script>
 <script>

        $(document).on("ready", setup);
        $(document).on("ready", inicio);
              function setup(){
                $.ajaxSetup({
                  beforeSend: function(xhr, settings) {
                    function getCookie(name) {
                      var cookieValue = null;
                        if (document.cookie && document.cookie != '') {
                          var cookies = document.cookie.split(';');
                            for (var i = 0; i < cookies.length; i++) {
                              var cookie = jQuery.trim(cookies[i]);
                              // Does this cookie string begin with the name we want?
                                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                break;
                                }
                            }
                        }
                    return cookieValue;
                    }
                    if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
                  // Only send the token to relative URLs i.e. locally.
                      xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                    }
                  }
                });
              }
        function inicio()
        {
           
             $(".item").on("click",eliminaritem);

        }
        function eliminaritem()
        {
            var item_id=$(this).val();
            var $this=$(this);
            console.log(item_id)
            $.ajax({
                data:{'item_id':item_id},
                type:"post",
                url:'/ajax_eliminaritem/',
                success: function(data) {
                    console.log(data);
                    var ojo = $this.parent().parent().hide('slow');
                    console.log(ojo);
                },
                error: function(data){
                    console.log(data);
                }
              });
            
        }



        </script>

</body>
</html>